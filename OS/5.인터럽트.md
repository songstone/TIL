# 인터럽트
- CPU가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치나 또는 예외 상황이 발생하여 처리가 필요할 경우 CPU에 알려서 처리하는 기술

## 인터럽트 필요 이유
- 선점형 스케쥴러 구현
    - running 중인 프로세스를 중단 시키고 다른 프로세스로 교체 시
- IO device 와의 커뮤니케이션
    - 저장 매체 등에서 처리 완료 시 프로세스를 꺠울 때(block -> ready)
- 예외 상황 핸들링
    - 입출력 하드웨어 등의 장치나 예외 상황이 발생할 경우 CPU가 해당 처리를 할 수 있도록 CPU에 전달

## 인터럽트 종류
- 내부 인터럽트
    - 주로 _프로그램 내부_ 에서 잘못된 명령 또는 잘못된 데이터 사용시 발생
        - 0으로 나눌 때
        - 사용자 모드에서 허용되지 않는 명령 또는 공간 접근 시
        - 계산 결과가 Overflow 또는 Underflow
    - 소프트웨어 인터럽트
- 외부 인터럽트
    - 주로 하드웨어에서 발생되는 이벤트. _프로그램 외부_
        - 전원 이상
        - 기계 문제
        - IO 관련 이벤트
    - 하드웨어 인터럽트

## 시스템 콜 인터럽트
- 시스템콜 실행 시 코드에 인터럽트 명령을 넣어 CPU에게 실행시켜야 한다.
    ```
    mov eax, 1 // 시스템 콜 번호
    mov ebx, 0 // 인자 번호
    int 0x80 // 소프트 웨어 인터럽트 명령 (CPU opcode, 시스템 콜에 해당하는 번호)
    ```
- 시스템콜 인터럽트 발생시
    1. CPU는 사용자 모드 -> 커널 모드
    2. IDT에서 0x80(시스템콜 번호)에 해당하는 주소 실행
    3. 함수에서 eax의 시스템 콜 번호에 해당하는 시스템콜 함수 실행
    4. 커널 모드 -> 사용자 모드, 프로세스 다음 코드 실행


## 인터럽트와 IDT
- 인터럽트는 미리 정의되어 각각 번호(이벤트)와 실행코드를 가리키는 주소가 기록
- IDT(Interrupt Descriptor Table)에 기록
- 부팅시 운영체제가 기록

## 인터럽트와 프로세스
1. 프로세스 실행 중 인터럽트 발생
2. 현 프로세스 중단
3. 운영체제가 인터럽트 처리 함수 실행 (IDT에서 해당 번호와 매칭된 함수를 호출)
4. 프로세스 재실행

## 선점형 스케쥴러
- 수시로 타이머 인터럽트를 발생
    - 정해진 타이머 인터럽트 발생 횟수를 채우면 다른 프로세스로 바꿔서 시분할 시스템을 구현한다.